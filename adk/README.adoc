= Mastering the Art of Agents
:toc: manual

== Concepts

=== What Developer really want?

To give developers a powerful, open foundation for building complex, production-ready AI agents intuitively and with greater control.


Open Foundation:

* Model Agnostic: Doubao, Gemini
* Deployment Agnostic: VKE, Google Cloud
* Interoperability: Easy to integrate with any framework

=== Agent Development Kit 

https://google.github.io/adk-docs/

Agent Development Kit (ADK) is a flexible and modular framework for developing and deploying AI agents. While optimized for Gemini and the Google ecosystem, ADK is model-agnostic, deployment-agnostic, and is built for compatibility with other frameworks. ADK was designed to make agent development feel more like software development, to make it easier for developers to create, deploy, and orchestrate agentic architectures that range from simple tasks to complex workflows.


Agent Development Kit offers several key advantages for developers building agentic applications:

1. Multi-Agent Systems: Build modular and scalable applications by composing multiple specialized agents in a hierarchy. Enable complex coordination and delegation.
2. Rich Tool Ecosystem: Equip agents with diverse capabilities: use pre-built tools (Search, Code Execution, etc.), create custom functions, integrate tools from third-party agent frameworks (LangChain, CrewAI), or even use other agents as tools.
3. Flexible Orchestration: Define workflows using workflow agents (SequentialAgent, ParallelAgent, and LoopAgent) for predictable pipelines, or leverage LLM-driven dynamic routing (LlmAgent transfer) for adaptive behavior.
4. Integrated Developer Experience: Develop, test, and debug locally with a powerful CLI and an interactive dev UI. Inspect events, state, and agent execution step-by-step.
5. Built-in Evaluation: Systematically assess agent performance by evaluating both the final response quality and the step-by-step execution trajectory against predefined test cases.
6. Deployment Ready: Containerize and deploy your agents anywhere – run locally, scale with Vertex AI Agent Engine, or integrate into custom infrastructure using Cloud Run or Docker.

Google ADK is built around a few core concepts that make it powerful and flexible:

* Agent: Agents are core building blocks designed to accomplish specific tasks. They can be powered by LLMs to reason, plan, and utilize tools to achieve goals, and can even collaborate on complex projects.
* Tools: Tools give agents abilities beyond conversation, letting them interact with external APIs, search information, run code, or call other services.
* Session Services: Session services handle the context of a single conversation (Session), including its history (Events) and the agent's working memory for that conversation (State).
* Callbacks: Custom code snippets you provide to run at specific points in the agent's process, allowing for checks, logging, or behavior modifications.
* Artifact Management: Artifacts allow agents to save, load, and manage files or binary data (like images or PDFs) associated with a session or user.
* Runner: The engine that manages the execution flow, orchestrates agent interactions based on Events, and coordinates with backend services.

=== VE Agent Development Kit

https://volcengine.github.io/veadk-python/

火山引擎智能体框架 VeADK（Volcengine Agent Development Kit），是由火山引擎推出的为 Agent 智能体的应用构建提供开发、部署、观测、评测等全流程云原生解决方案。

相较于现有的智能体开发框架，VeADK 具备与火山引擎产品体系深度融合的优势，帮助开发者更高效地构建企业级 AI 智能体应用。


=== Course

* link:https://www.skills.google/course_templates/1382[Build intelligent agents with Agent Development Kit (ADK)]
* link:https://www.skills.google/course_templates/1275[Deploy Multi-Agent Systems with Agent Development Kit (ADK)]
* link:https://github.com/volcengine/veadk-python/blob/main/veadk_tutorial.ipynb[Volcengine Agent Development Kit 教程]

== Development Environment

=== Python

[source,bash]
----
uv venv --python 3.12
source .venv/bin/activate
uv pip install google-adk
uv pip install veadk-python
----

=== Mysql

[source, bash]
----
docker run -d \
  --name mysql \
  -e MYSQL_ROOT_PASSWORD=root \
  -p 3306:3306 \
  mysql:8.0
----

[source, bash]
----
docker exec -it mysql bash
mysql -uroot -p
----

[source, bash]
----
CREATE DATABASE VEADK;
USE VEADK;
SHOW TABLES;
----

== Getting Start

=== my_agent

[source, bash]
.*1. create project*
----
adk create my_agent
----

*2. update code*

link:my_agent/agent.py[agent.py]

[source, bash]
.*3. run agent*
----
veadk web
----

[source, bash]
.*4. Run Agent CLI*
----
python my_agent/agent.py
----

=== web_search_agent 

[source, bash]
----
web_search_agent/agent.py
----

=== terminal_agent

[source, bash]
.*ShortTermMemory Local File*
----
python terminal_agent/short_mem_local_agent.py
----

[source, bash]
.*ShortTermMemory Mysql*
----
python terminal_agent/short_mem_mysql_agent.py
----

[source, bash]
.*LongTermMemory Opensearch*
----
python terminal_agent/long_mem_opensearch_agent.py
----

[source, bash]
.*LongTermMemory Viking*
----
terminal_agent/long_mem_viking_agent.py
----

=== intent_recognition_agent

[source, bash]
----
python intent_recognition_agent/agent.py 
----

== Empower Agent

=== Callback

image:img/adk_callback_points.png[]

[source, bash]
.*1. define callback fuction*
----
chinese_content_moderator_agent = Agent(
    name="ChineseContentModerator",
    description="一个演示全链路回调和护栏功能的中文内容审查助手。",
    instruction="你是一个内容助手，可以根据用户要求撰写文章。利用好工具",
    tools=[write_article],
    before_agent_callback=before_agent_callback,
    before_model_callback=before_model_callback,
    after_model_callback=after_model_callback,
    before_tool_callback=before_tool_callback,
    after_tool_callback=after_tool_callback,
    after_agent_callback=after_agent_callback,
)
----

[source, bash]
.*2. start adk web*
----
veadk web
----

[source, bash]
.*3. test prompt*
----
// 场景1: 正常调用，触发工具和PII过滤 
请帮我写一篇关于'人工智能未来'的500字文章。

// 场景2: 输入包含敏感词，被护栏拦截
你好，我想了解一些关于 zanghua 的信息。

// 场景3: 工具参数校验失败 
写一篇关于'太空探索'的文章，字数-100。
----

=== MCP


