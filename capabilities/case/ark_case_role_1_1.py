import os
from volcenginesdkarkruntime import Ark

API_KEY = os.environ.get("ARK_API_KEY")
API_EP_ID = os.environ.get("ARK_API_ENGPOINT_ID")

prompt_system = """
你是一位经验丰富、极为专业的外呼客户服务满意度专员，任务是对外呼坐席的对话文本进行角色分类和处理。

请根据以下步骤操作：

## 技能1：坐席识别标准
根据以下特征判断哪些话语属于坐席：
1. **介绍身份**：如果对话的前5轮内，某一方声明自己是某公司的工作人员（例如：我是XXX消费金融的客户服务专员），该部分话语属于坐席。
2. **催收人员**：若对话中的角色为催收人员，其言辞通常与催收、还款等事项相关，应视为坐席角色。
3. **主动拨打电话**：通常，坐席主动拨打电话给客户。如果是客户主动拨打电话，开场白通常会问“您是XXXX公司的吗？”此类对话为坐席角色。

## 技能2：关键词替换
在识别出坐席话语后，逐行将坐席相关的内容中的“人物 - 1/2”替换为“坐席”，未替换部分则替换为“客户”。
- 将“ACME”替换为“XXX”以保护公司隐私。

## 技能3：输出格式要求
请严格按照以下输出格式执行：
客户/坐席：xxxxxxx  
客户/坐席：xxxxxxx  

输出时务必保持对话的顺序，并严格区分角色。

现在请开始处理并输出对话内容。
"""

ptompt_user = """
您好，请问是王先生吗？是的，请问您是？您好，我是ACME消费金融的客户服务专员张丽，来电是为了提醒您本月的还款情况，希望占用您几分钟时间说明情况。根据系统记录，您的贷款账户[尾号1234]本月的还款金额是2000元，约定还款日是1月5日。请问您是否清楚这个信息？嗯，知道的。好的，为了确保您的信用记录不受影响，我们建议您在约定日期前完成还款。如果您需要了解还款方式或者有任何问题，可以随时拨打我们的服务热线[400-123-4567]，我们会协助您处理。哦，我的手机号码换了一个新的，之前登记的号码可能联系不到我了。了解，那为了方便我们后续联系，请问可以更新一下您的新号码吗？可以，新号码是13881985678。好的，我已经为您更新了系统信息。如果有其他需要协助的地方，您也可以通过我们的官网或者APP进行相关操作。感谢您的时间，如果您还有其他问题，可以随时联系我们的客户服务热线。祝您新年愉快，生活顺利！好的，谢谢！
"""

client = Ark(api_key=API_KEY)
completion = client.chat.completions.create(
    model=API_EP_ID,
    messages=[
        {"role": "system", "content": prompt_system},
        {"role": "user", "content": ptompt_user},
    ]
)

print(completion.choices[0].message.content)

print(completion.usage)

